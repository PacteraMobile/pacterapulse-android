language: android

jdk:
 #- oraclejdk7
 - oraclejdk8


# http://docs.travis-ci.com/user/caching/
cache:
  gradlew: true
  gradle: true
  directories:
    - $HOME/.gradle
    - $HOME/.m2

sudo: false

before_install:
  - ls -a
  - pwd
  # display list of all possible components
  - android list sdk --no-ui --all --extended | grep -E '^id:' | awk -F '"' '{$1=""; print $2}'
  # display list of installed emulators
  - android list targets | grep -e '^\(\(id:\)\|\( Tag\)\)'

env:
  global:
    - TERM=dumb
  matrix:
    # run 'android list targets & pause' to see list of possible targets for matrix
    - ANDROID_TARGET=android-22  ANDROID_ABI=armeabi-v7a

android:
  components:
    - platform-tools
    - tools
    - build-tools-22.0.1
    - android-22
    # For Google Maps API v1
    - addon-google_apis-google-22
    # Google Play Services
    - extra-google-google_play_services
    # Support library
    - extra-android-support
    # Latest artifacts in local repository
    - extra-google-m2repository
    - extra-android-m2repository
    # Specify at least one system image
    #- sys-img-armeabi-v7a-addon-google_apis-google-$ANDROID_API_LEVEL

install:
  - true

before_script:
  # Create and start emulator
  - echo no | android create avd --force -n test -t "Google Inc.:Google APIs:"$ANDROID_API_LEVEL --abi $ANDROID_ABI
  - emulator -avd test -no-skin -no-audio -no-window &
  #- ./wait_for_emulator
  #- adb shell input keyevent 82 &

script:

  - ./gradlew createDebugCoverageReport coveralls

notifications:
  email: true
  slack: pacteraaus:HMpth3Uwqh8O3AdXo45fKkxJ
